"use strict";var _createClass=function(){function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}define(["jquery","jquerycookie"],function(l){return{init:function(){function t(){_classCallCheck(this,t),this.cookiesids=l.cookie("cookiesids"),this.cookienums=l.cookie("cookienums")}(new(_createClass(t,[{key:"init",value:function(){this.itt(),l(".title").text("欢迎采购"),this.jiesuan(),l(document).on("mousedown",function(t){if("IMG"==((t=t||event).target||t.srcElement).nodeName)return!1})}},{key:"itt",value:function(){var t,e;this.cookiesids?(t=this.cookiesids.split(","),e=this.cookienums.split(","),this.getSid(t,e)):(l(".cart_box").hide(),l(".cart_sumbit_box").hide(),l(".empty").show()),l(".c-s-box-left").on("click",function(){l.cookie("cookiesids","",{expires:-1,path:"/"}),l.cookie("cookienums","",{expires:-1,path:"/"}),l(".cart_box").hide(),l(".empty").show(),l(".cart_goods_cart").html("")})}},{key:"getSid",value:function(t,o){var n=this,i="",s=0,c=0,e=!0,a=!1,u=void 0;try{for(var r,p=t[Symbol.iterator]();!(e=(r=p.next()).done);e=!0)!function(){var t=r.value,e=o[s];s++,l.ajax({url:"http://10.31.152.53/zol/php/detail.php",data:"sid="+t,type:"post",dataType:"json"}).done(function(t){c+=e*parseInt(t.price),i+=' \n                                <div class="goods">\n                                    <div class="imgcon">\n                                        <img src='+t.src+' alt="">\n                                    </div>\n                                    <span>'+t.title+" </span>\n                                    <span class='danjia'>"+t.price+'.00</span>\n                                    <div class="c-proCount">\n                                        <span class="reduce">-</span>\n                                        <span class="c-proCount-input">'+e+"</span>\n                                        <span class=\"plus\">+</span>\n                                    </div>\n                                    <span class='jiage'>"+e*t.price+".00</span>\n                                    <span class='deleteee'>删除</span>\n                                </div>\n                               ",l(".cart_goods_cart").html(i),l(".nums").text(l(".goods").length),l(".c-s-box-r-priceCount span").text("￥"+c+".00"),n.homes(),n.count(),n.dele()})}()}catch(t){a=!0,u=t}finally{try{!e&&p.return&&p.return()}finally{if(a)throw u}}}},{key:"homes",value:function(){var o=0;l(".c-proCount-input").each(function(t,e){o+=parseInt(l(e).text()),l(".numss").text(o)})}},{key:"count",value:function(){l(".reduce").each(function(s,t){l(t).on("click",function(){var o,n,t,e,i;l(l(".c-proCount-input")[s]).text()<=1||(n=o=0,l(l(".c-proCount-input")[s]).text(l(l(".c-proCount-input")[s]).text()-1),l(l(".jiage")[s]).text(l(l(".c-proCount-input")[s]).text()*l(l(".danjia")[s]).text()+".00"),l(".c-s-box-r-preCount span").text(),l(".c-proCount-input").each(function(t,e){n+=parseInt(l(e).text()),l(".numss").text(n)}),l(".jiage").each(function(t,e){o+=parseInt(l(e).text()),l(".c-s-box-r-priceCount span").text("￥"+o+".00")}),t=l.cookie("cookienums").split(","),e=l(l(".c-proCount-input")[s]).text(),t[s]=e,t.join(","),i=t.join(","),l.cookie("cookienums",i,{expires:7,path:"/"}))})}),l(".plus").each(function(s,t){l(t).on("click",function(){var o,n,t,e,i;999<=l(l(".c-proCount-input")[s]).text()||(l(l(".c-proCount-input")[s]).text(parseInt(l(l(".c-proCount-input")[s]).text())+1),l(l(".jiage")[s]).text(l(l(".c-proCount-input")[s]).text()*l(l(".danjia")[s]).text()+".00"),n=o=0,l(".c-proCount-input").each(function(t,e){n+=parseInt(l(e).text()),l(".numss").text(n)}),l(".jiage").each(function(t,e){o+=parseInt(l(e).text()),l(".c-s-box-r-priceCount span").text("￥"+o+".00")}),t=l.cookie("cookienums").split(","),e=l(l(".c-proCount-input")[s]).text(),t[s]=e,t.join(","),i=t.join(","),console.log(i),l.cookie("cookienums",i,{expires:7,path:"/"}))})})}},{key:"dele",value:function(){var r=this;l(".deleteee").each(function(u,t){l(t).on("click",function(){var t=l.cookie("cookiesids").split(","),e=l.cookie("cookienums").split(",");t.splice(u,1),e.splice(u,1);var o=t.join(","),n=e.join(",");l.cookie("cookiesids",o,{expires:7,path:"/"}),l.cookie("cookienums",n,{expires:7,path:"/"}),l(".goods:hidden").length==l(".goods").length-1&&(l.cookie("cookiesids","",{expires:-1,path:"/"}),l.cookie("cookienums","",{expires:-1,path:"/"})),""!=l.cookie("cookiesids")&&l.cookie("cookiesids")||(l(".cart_sumbit_box").hide(),l(".cart_box").hide(),l(".empty").show()),l(l(".goods")[u]).hide(),l(".nums").text(l(".goods").length-l(".goods:hidden").length);var i=parseInt(l(l(".jiage")[u]).text()),s=l(".c-s-box-r-priceCount span").text().match(/\d{1,10}/)[0];console.log(s),l(l(".c-s-box-r-priceCount span")[u]).text("￥"+(s-i)+".00");var c=parseInt(l(l(".c-proCount-input")[u]).text()),a=l(".numss").text();r.zonggeshu=a-c,console.log(a-c),l(l(".numss")[u]).text(a-c)})})}},{key:"jiesuan",value:function(){l(".c-s-box-r-submit").on("click",function(){l(".jiesuan").css("visibility","visible"),setTimeout(function(){l(".jiesuan").css("visibility","hidden")},1e3)})}}]),t)).init()}}});